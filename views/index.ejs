 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8" />
     <meta name="viewport" content="width=device-width, initial-scale=1.0" />
     <title>Digipog Example</title>
     <link rel="stylesheet" href="/static/styles.css" />
     <script>
        async function post(path, body) {
            const res = await fetch(path, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(body)
            });
            const text = await res.text();
            try { return JSON.parse(text); } catch { return { raw: text }; }
        }

        async function doTransfer() {
            const from = document.getElementById('from').value;
            const to = document.getElementById('to').value;
            const amount = document.getElementById('amount').value;
            const pin = document.getElementById('pin').value;
            const reason = document.getElementById('reason').value;
            setResult('Transferring...');

             const result = await post('/transfer', { from, to, amount, pin, reason });
             setResult(JSON.stringify(result, null, 2));
        }

        function setResult(text) {
             const resultElement = document.getElementById('result');
             resultElement.textContent = text;
        }
    </script>
    <style>
        body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial; padding: 24px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; max-width: 1000px; }
        .card { border: 1px solid #ddd; border-radius: 8px; padding: 16px; }
        .row { display: grid; grid-template-columns: 160px 1fr; align-items: center; gap: 12px; margin: 8px 0; }
        input, textarea { padding: 8px; font-size: 14px; width: 100%; }
        button { padding: 10px 16px; font-weight: 600; cursor: pointer; }
        pre { white-space: pre-wrap; background: #111; color: #0f0; padding: 12px; border-radius: 8px; }
        .warn { color: #a00; font-weight: 700; }
        .ok { color: #0a0; font-weight: 700; }
    </style>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const pkOk = <%- JSON.stringify(config.HAS_PUBLIC_KEY) %>;
            document.getElementById('pkStatus').textContent = pkOk ? 'Loaded' : 'Missing (will not verify JWT)';
            document.getElementById('pkStatus').className = pkOk ? 'ok' : 'warn';
        });
    </script>
 </head>
 <body>
     <div class="container">
         <h1>Digipog Example</h1>
        <div class="subtitle">Transfer digipogs via Formbar HTTP API</div>
 
         <div class="grid">
             <div class="card">
                 <h3 style="margin-top:0">Environment</h3>
                 <div class="row"><label class="small">Formbar address</label><div><code><%- config.FORMBAR_ADDRESS %></code></div></div>
                 <div class="row">
                     <label class="small">Status</label>
                     <div class="badges">
                         <span class="badge <%- config.HAS_PUBLIC_KEY ? 'ok' : 'warn' %>"><span class="dot"></span> Public Key: <%- config.HAS_PUBLIC_KEY ? 'Loaded' : 'Missing' %></span>
                     </div>
                 </div>
                 <div class="row"><label class="small">How to configure</label><div>Set values in <code>.env</code> inside this folder.</div></div>
             </div>
 
             <div class="card">
                 <h3 style="margin-top:0">Transfer</h3>
                 <div class="row"><label class="small">From user id</label><div><input id="from" placeholder="e.g. 2" /></div></div>
                 <div class="row"><label class="small">To user id</label><div><input id="to" placeholder="e.g. 3" /></div></div>
                 <div class="row"><label class="small">Amount</label><div><input id="amount" type="number" min="1" step="1" value="1" /></div></div>
                 <div class="row"><label class="small">PIN</label><div><input id="pin" type="number" min="0" step="1" placeholder="Sender's PIN" /></div></div>
                <div class="row"><label class="small">Reason</label><div><input id="reason" placeholder="e.g. Purchase: Shapes That Go" value="" /></div></div>
                 <div class="actions"><button class="primary" onclick="doTransfer()">Send Transfer</button></div>
             </div>
         </div>
 
         <div class="card" style="margin-top: 24px;">
             <h3 style="margin-top:0">Result</h3>
             <pre id="result">Ready.</pre>
         </div>
     </div>
 </body>
 </html>


